# React with Onion Architecture

이 프로젝트는 [<쏙쏙 들어오는 함수형 코딩>(에릭 노먼드, 제이펍, 2022)](http://www.yes24.com/Product/Goods/108748841)에서 제안하는 함수형 코딩 기법과 어니언 아키텍처를, 리액트를 이용한 웹 서비스에서 적용해보기 위해 작성한 샘플 코드입니다.

## 함수형 코딩

<쏙쏙 들어오는 함수형 코딩>의 저자인 에릭 노먼드가 제안하는 함수형 코딩의 기본 개념은 '액션'에서 '계산'을 추출하는 것입니다. '계산'이란 암묵적인 입력과 출력이 없는 함수, 다르게 말하면 전역변수를 사용하지 않고 부수효과가 없는 순수함수를 의미합니다. 따라서 '계산'은 테스트가 용이하고 재사용성이 좋지만 '계산'이 아닌 '액션'은 그렇지 않습니다. '액션'은 최소한으로 유지될 수 있도록 해야 하며, 버그가 발생되지 않도록 관리되어야 합니다.

## 계층형 구조

코드의 가독성을 떨어뜨리는 원인 중 하나는 함수가 서로 다른 추상화 수준의 코드 또는 함수로 작성되기 때문입니다. 따라서 함수를 추상화 수준에 따라 계층을 나누어 함수를 구성하는 함수는 구성되는 함수보다 아래의 계층이 되도록 해야 합니다. (같은 계층의 함수를 호출해서도 안됩니다.) 높은 계층에 속한 함수일수록 더 추상적인 수준의 코드/함수로 작성되고, 더 구체적인 상황에서 사용됩니다. 이렇게 코드를 계층형 구조가 되도록 작성하면, 액션은 상위의 계층에 계산은 하위의 계층에 속하게 됩니다.

## 어니언 아키텍처

에릭 노먼드가 제안하는 가장 단순한 어니언 아케텍처는 '인터랙션', '도메인', '언어'의 세 계층으로 이루어진 '계층형 구조'입니다. 도메인 계층은 비즈니스 로직을 정의하는 계산으로 이루어져 있고, 언어 계층은 비즈니스 로직을 구현하기 위한 계산들로 이루어져 있습니다. 그리고 인터랙션 계층은 현실 세계와 도메인 간의 상호 작용이 적용되어 있는 계층으로, 액션으로 이루어져 있습니다. 이 계층들은 내부적으로 각각 계층형 구조를 이루지만, 도메인 계층에서는 언어 계층의 최상위 계층에만 접근가능하며, 인터랙션 계층은 도메인 계층의 최상위 계층에만 접근 가능합니다. 이렇게 상위의 계층에서 접근가능한 하위 계층의 최상위 계층을, 에릭 노먼드는, '인터페이스' 또는 '추상화 벽'이라고 부릅니다. 상위 계층에서는 하위 계층의 인터페이스에 속하는 함수들만 사용할 수 있는데, 하위 계층의 모든 함수를 알아야 하는 부담을 줄일 수 있기 때문입니다.

## 디렉토리 구조

```
├─ interaction
│ ├─ functions
│ │  └─ layer
│ │     └─ ...
│ └─ components
│    └─ layer
│       └─ ...
├─ domain
│  └─ layer
│     └─ ...
└─ library
   └─ layer
      └─ layer
         └─ ...

```

`library`, `domain`, `interaction`은 각각 어니언 아키첵처에서의 언어 계층, 도메인 계층, 인터랙션 계층에 해당하는 디렉토리입니다. 언어 계층, 도메인 계층, 인터랙션 계층은 디렉토리 상으로는 같은 계층에 속해 있지만, `interaction`이 가장 상위의 계층으로 `library`가 가장 하위의 계층으로 이해해야 합니다. `library`, `domain`, `interaction` 각 디렉토리의 내부에서는, 계층의 위계 구조가 명확히 드러나도록, 개념상의 계층과 디렉토리 구소 상의 계층이 일치하도록 서브 디렉토리를 만들어 하위 계층을 구현했습니다. (그리고 네이밍의 어려움을 피하기 위해 특별한 경우가 아니라면, 그 서브 디렉토리 이름을 `layer`로 정했습니다.)

따라서 언어 계층의 인터페이스에 속하는 함수들은 `library` 디렉토리에 있는 파일에 작성된 함수들을 의미하게 되고, 도메인 계층의 인터페이스는 `domain`의 서브 디렉토리가 아닌 곳에서 작성된 함수들을 의미하게 됩니다.

`components`는 리액트 컴포넌트 중 프리젠터가 계층 별로 정의되어 있는 디렉토리이고, `functions`는 `components`와 리액트 훅을 포함한 ‘액션’이 정의되어 있는 디렉토리입니다. 프리젠트는 ‘계산’으로 볼 수 있기 때문에 `function`의 서브 디렉토리에 포함되어야 한다고 잘못 생각할 수 있지만, 훅 등의 액션이 프리젠터를 호출하지 않기 때문에, 하위 계층으로 볼 수는 없습니다.
